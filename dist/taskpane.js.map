{"version":3,"file":"taskpane.js","mappings":"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","sources":["webpack:///webpack/bootstrap?","webpack:///./src/taskpane/taskpane.js?","webpack:///webpack/runtime/define property getters?","webpack:///webpack/runtime/hasOwnProperty shorthand?"],"sourcesContent":["// The require scope\nvar __webpack_require__ = {};\n\n","/*\n * Copyright (c) Microsoft Corporation. All rights reserved. Licensed under the MIT license.\n * See LICENSE in the project root for license information.\n */\n\n/* global document, Office */\n\nOffice.onReady((info) => {\n  if (info.host === Office.HostType.Outlook) {\n    document.getElementById(\"sideload-msg\").style.display = \"none\";\n    document.getElementById(\"app-body\").style.display = \"flex\";\n    document.getElementById(\"app-body\").style.display = \"flex\";\n    document.getElementById(\"app-submit\").onclick = closeItem;\n    document.getElementById(\"app-refresh\").onclick = saveAppointmentInfo;\n    document.getElementById(\"email\").onkeyup = validateEmail;\n    document.getElementById(\"sms\").onkeyup = validateSms;\n    //document.getElementById(\"run\").onclick = run;\n    //document.getElementById(\"email\").onclick = email;\n    run();\n  }\n});\n\nexport async function run() {\n  var mailbox = Office.context.mailbox;\n\n  document.querySelector(\"#autosave\").checked = true;\n  var item = await mailbox.item;\n  item.loadCustomPropertiesAsync((result) => {\n    const props = result.value;\n    //const email = props.get(\"ARS-Email\");\n    if (props.get(\"ARS-Email\") !== undefined) document.getElementById(\"email\").value = props.get(\"ARS-Email\");\n    if (props.get(\"ARS-Phone\") !== undefined) document.getElementById(\"sms\").value = props.get(\"ARS-Phone\");\n    if (props.get(\"ARS-Host\") !== undefined) document.getElementById(\"host\").value = props.get(\"ARS-Host\");\n    if (props.get(\"ARS-Location\") !== undefined) document.getElementById(\"location\").value = props.get(\"ARS-Location\");\n    if (props.get(\"ARS-MeetingPhone\") !== undefined)\n      document.getElementById(\"Phone\").value = props.get(\"ARS-MeetingPhone\");\n    if (props.get(\"ARS-Enabled\") !== undefined)\n      document.querySelector(\"#enableReminder\").checked = Boolean(props.get(\"ARS-Enabled\"));\n    if (props.get(\"ARS-Status\") !== undefined)\n      document.getElementById(\"ReminderStatus\").innerHTML = props.get(\"ARS-Status\");\n    else document.getElementById(\"ReminderStatus\").innerHTML = \"Not enabled\";\n    item.organizer.getAsync((host) => {\n      if (props.get(\"ARS-Host\") === undefined) document.getElementById(\"host\").value = host.value.displayName;\n    });\n  });\n}\n\nexport async function closeItem() {\n  await saveAppointmentInfo();\n  //Office.context.mailbox.item.close();\n}\n\nexport async function saveAppointmentInfo() {\n  var item = Office.context.mailbox.item;\n  var email = document.getElementById(\"email\").value;\n  var sms = document.getElementById(\"sms\").value;\n  var host = document.getElementById(\"host\").value;\n  var location = document.getElementById(\"location\").value;\n  var phone = document.getElementById(\"Phone\").value;\n  var enableReminder = document.querySelector(\"#enableReminder\").checked;\n  var autosave = document.querySelector(\"#autosave\").checked;\n\n  item.loadCustomPropertiesAsync((result) => {\n    const props = result.value;\n    props.set(\"ARS-Email\", email);\n    props.set(\"ARS-Phone\", sms);\n    props.set(\"ARS-Host\", host);\n    props.set(\"ARS-Location\", location);\n    props.set(\"ARS-MeetingPhone\", phone);\n    props.set(\"ARS-Enabled\", enableReminder);\n    props.set(\"ARS-Status\", \"PENDING\");\n    props.saveAsync((saveResult) => {\n      console.log(\"SAVE_CUSTOM_PROP\", saveResult);\n    });\n    if (autosave) {\n      Office.context.mailbox.item.saveAsync().then(() => console.log(\"called from inside\"));\n    }\n  });\n}\n\nexport function validateEmail(e) {\n  const regex = /^(([^<>()[\\]\\.,;:\\s@\\\"]+(\\.[^<>()[\\]\\.,;:\\s@\\\"]+)*)|(\\\".+\\\"))@(([^<>()[\\]\\.,;:\\s@\\\"]+\\.)+[^<>()[\\]\\.,;:\\s@\\\"]{2,})$/i;\n  const textValue = e.srcElement.value;\n  if (textValue.match(regex)) document.getElementById(\"emailProvided\").src = \"../../assets/checked.png\";\n  else document.getElementById(\"emailProvided\").src = \"../../assets/cancel.png\";\n}\n\nexport function validateSms(e) {\n  const regex = /^((((0{2}?)|(\\+){1})46)|0)7[\\d]{8}[0-9]*$/i;\n  const zeroRegex = /^0/i;\n  var textValue = e.srcElement.value;\n  textValue = textValue.replace(zeroRegex, \"+46\");\n  if (textValue.match(regex)) document.getElementById(\"smsProvided\").src = \"../../assets/checked.png\";\n  else document.getElementById(\"smsProvided\").src = \"../../assets/cancel.png\";\n}","// define getter functions for harmony exports\n__webpack_require__.d = function(exports, definition) {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = function(obj, prop) { return Object.prototype.hasOwnProperty.call(obj, prop); }"],"names":["__webpack_require__","mailbox","Office","context","document","querySelector","checked","item","loadCustomPropertiesAsync","result","props","value","undefined","get","getElementById","Boolean","innerHTML","organizer","getAsync","host","displayName","closeItem","saveAppointmentInfo","email","sms","location","phone","enableReminder","autosave","set","saveAsync","saveResult","console","log","then","validateEmail","e","srcElement","match","src","validateSms","textValue","replace","d","exports","definition","key","o","Object","defineProperty","enumerable","obj","prop","prototype","hasOwnProperty","call","onReady","info","HostType","Outlook","style","display","onclick","onkeyup","run"],"sourceRoot":""}
!function(){"use strict";var e={};function t(e,t,n,o,c,r,a){try{var u=e[r](a),i=u.value}catch(e){return void n(e)}u.done?t(i):Promise.resolve(i).then(o,c)}function n(e){return function(){var n=this,o=arguments;return new Promise((function(c,r){var a=e.apply(n,o);function u(e){t(a,c,r,u,i,"next",e)}function i(e){t(a,c,r,u,i,"throw",e)}u(void 0)}))}}function o(){return(o=n(regeneratorRuntime.mark((function e(){var t,n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=Office.context.mailbox,document.querySelector("#autosave").checked=!0,e.next=4,t.item;case 4:(n=e.sent).loadCustomPropertiesAsync((function(e){var t=e.value;void 0!==t.get("ARS-Email")&&(document.getElementById("email").value=t.get("ARS-Email")),void 0!==t.get("ARS-Phone")&&(document.getElementById("sms").value=t.get("ARS-Phone")),void 0!==t.get("ARS-Host")&&(document.getElementById("host").value=t.get("ARS-Host")),void 0!==t.get("ARS-Location")&&(document.getElementById("location").value=t.get("ARS-Location")),void 0!==t.get("ARS-MeetingPhone")&&(document.getElementById("Phone").value=t.get("ARS-MeetingPhone")),void 0!==t.get("ARS-Enabled")&&(document.querySelector("#enableReminder").checked=Boolean(t.get("ARS-Enabled"))),void 0!==t.get("ARS-Status")?document.getElementById("ReminderStatus").innerHTML=t.get("ARS-Status"):document.getElementById("ReminderStatus").innerHTML="Not enabled",n.organizer.getAsync((function(e){void 0===t.get("ARS-Host")&&(document.getElementById("host").value=e.value.displayName)}))}));case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function c(){return r.apply(this,arguments)}function r(){return(r=n(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a();case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function a(){return u.apply(this,arguments)}function u(){return(u=n(regeneratorRuntime.mark((function e(){var t,n,o,c,r,a,u,i;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=Office.context.mailbox.item,n=document.getElementById("email").value,o=document.getElementById("sms").value,c=document.getElementById("host").value,r=document.getElementById("location").value,a=document.getElementById("Phone").value,u=document.querySelector("#enableReminder").checked,i=document.querySelector("#autosave").checked,t.loadCustomPropertiesAsync((function(e){var t=e.value;t.set("ARS-Email",n),t.set("ARS-Phone",o),t.set("ARS-Host",c),t.set("ARS-Location",r),t.set("ARS-MeetingPhone",a),t.set("ARS-Enabled",u),t.set("ARS-Status","PENDING"),t.saveAsync((function(e){console.log("SAVE_CUSTOM_PROP",e)})),i&&Office.context.mailbox.item.saveAsync().then((function(){return console.log("called from inside")}))}));case 9:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function i(e){e.srcElement.value.match(/^(([^<>()[\]\.,;:\s@\"]+(\.[^<>()[\]\.,;:\s@\"]+)*)|(\".+\"))@(([^<>()[\]\.,;:\s@\"]+\.)+[^<>()[\]\.,;:\s@\"]{2,})$/i)?document.getElementById("emailProvided").src="../../assets/checked.png":document.getElementById("emailProvided").src="../../assets/cancel.png"}function s(e){var t=e.srcElement.value;(t=t.replace(/^0/i,"+46")).match(/^((((0{2}?)|(\+){1})46)|0)7[\d]{8}[0-9]*$/i)?document.getElementById("smsProvided").src="../../assets/checked.png":document.getElementById("smsProvided").src="../../assets/cancel.png"}e.d=function(t,n){for(var o in n)e.o(n,o)&&!e.o(t,o)&&Object.defineProperty(t,o,{enumerable:!0,get:n[o]})},e.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},Office.onReady((function(e){e.host===Office.HostType.Outlook&&(document.getElementById("sideload-msg").style.display="none",document.getElementById("app-body").style.display="flex",document.getElementById("app-body").style.display="flex",document.getElementById("app-submit").onclick=c,document.getElementById("app-refresh").onclick=a,document.getElementById("email").onkeyup=i,document.getElementById("sms").onkeyup=s,function(){o.apply(this,arguments)}())}))}();
//# sourceMappingURL=taskpane.js.map